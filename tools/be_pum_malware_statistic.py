import glob
import re

data_folder = "data/log_bepum_malware"
files = glob.glob(data_folder + "/Log-*")

cnt = 0
for file in files:
    with open(file, "r") as f:
        for line in f:
            if "Packer Identified" in line:
                pattern = r"Packer Identified:\s+(\S+)\s+0x"
                match = re.search(pattern, line)
                if match:
                    packer = match.group(1)
                    if packer != "NONE":
                        print(packer)
                        cnt += 1

print("Total: {}".format(cnt))